---
layout: post
title: "Typia"
description: >
hide_last_modified: true
---

# Typia

---

# ğŸš‚Â Motivation

ìƒˆë¡œ ì‹œì‘í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ OpenAPI-Generatorë¥¼ ì ìš©í•˜ë©° class-validatorë¡œ codegen templateì„ ì ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, typiaë¡œ ì ìš©ì‹œì¼œë³´ê³  ì‹¶ì–´ì§.

**ì •ë¦¬í•œ ê¸€ì—ëŠ” Typiaì˜ ì „ì²´ì ì¸ ì‚¬ìš©ì²˜ë³´ë‹¨, class-validatorë¥¼ Typiaë¡œ ëŒ€ì²´í•œ ê³¼ì •ë§Œ ì„œìˆ í•©ë‹ˆë‹¤.**

# â­Â What I Learned

NestJsì˜ ê°€ì¥ ëŒ€í‘œì ì¸ validation ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” class-validatorì´ë€ ë…€ì„ì…ë‹ˆë‹¤. 
ì´ë¥¼ í†µí•´ DTOë¥¼ êµ¬ì„±í•  ë•ŒëŠ” ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¡œ ì‘ì„±ë©ë‹ˆë‹¤.

### Class-validator

```typescript
// class-validator
import { ApiProperty } from "@nestjs/swagger";
import {
  ArrayNotEmpty,
  IsArray,
  IsObject,
  IsOptional,
  IsString,
  Match,
  MaxLength,
  Type,
  ValidateNested,
} from "class-validator";
 
export class BbsArticle {
  @ApiProperty({
    format: "uuid",
  })
  @IsString()
  id!: string;
 
  @ApiProperty({
    type: () => AttachmentFile,
    nullable: true,
    isArray: true,
    description: "List of attached files.",
  })
  @Type(() => AttachmentFile)
  @IsArray()
  @IsOptional()
  @IsObject({ each: true })
  @ValidateNested({ each: true })
  files!: AttachmentFile[] | null;
 
  @ApiProperty({
    type: "string",
    nullable: true,
    minLength: 5,
    maxLength: 100,
    description: "Title of the article.",
  })
  @IsOptional()
  @IsString()
  title!: string | null;
 
  @ApiProperty({
    description: "Main content body of the article.",
  })
  @IsString()
  body!: string;
 
  @ApiProperty({
    format: "date-time",
    description: "Creation time of article",
  })
  @IsString()
  created_at!: string;
}
 
export class AttachmentFile {
  @ApiProperty({
    type: "string",
    maxLength: 255,
    pattern: "^[a-zA-Z0-9-_]+$",
    description: "File name.",
  })
  @Matches(/^[a-z0-9]+$/)
  @MaxLength(255)
  @IsString()
  name!: string | null;
 
  @ApiProperty({
    type: "string",
    nullable: true,
    maxLength: 255,
    pattern: "^[a-zA-Z0-9-_]+$",
    description: "File extension.",
  })
  @Matches(/^[a-z0-9]+$/)
  @MaxLength(8)
  @IsOptional()
  @IsString()
  extension!: string | null;
 
  @ApiProperty({
    format: "url",
    description: "URL of the file.",
  })
  @IsString()
  url!: string;
}
```

ì–´ë–»ê²Œ ë³´ë©´ ê°€ë…ì„±ì´ ì¢‹ë‹¤ê³  ìƒê°í•  ìˆœ ìˆì§€ë§Œ, ì¤‘ë³µë˜ëŠ” ì½”ë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.

> ğŸ’¡ 1. Swaggerì— ì„ ì–¸í•˜ê¸° ìœ„í•œ ApiProperty ë°ì½”ë ˆì´í„°  
>   
> 2. DTOë‹¨ì—ì„œ íƒ€ì…ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ë°ì½”ë ˆì´í„°(IsString, IsNumber ë“±)  
>   
> 3. ì§ì ‘ì ìœ¼ë¡œ ì„ ì–¸í•´ë‘ëŠ” íƒ€ì…(title!: string | null ë“±)
	1. Swaggerì— ì„ ì–¸í•˜ê¸° ìœ„í•œ ApiProperty ë°ì½”ë ˆì´í„°
	2. DTOë‹¨ì—ì„œ íƒ€ì…ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ë°ì½”ë ˆì´í„°(IsString, IsNumber ë“±)
	3. ì§ì ‘ì ìœ¼ë¡œ ì„ ì–¸í•´ë‘ëŠ” íƒ€ì…(title!: string | null ë“±)
### 
Typia

ì´ë¥¼ TypiaëŠ” ê°€ë…ì„± ì¢‹ê²Œ, ì‹¬ì§€ì–´ëŠ” 20,000ë°° ë¹ ë¥´ê²Œ ê²€ì¦í•©ë‹ˆë‹¤.
ì•„ë˜ëŠ” ìœ„ ì½”ë“œë¥¼ Typiaë¡œ ë³€ê²½í•œ ì½”ë“œì…ë‹ˆë‹¤.

```typescript
// Typia
import typia, { tags } from "typia";
 
export interface IBbsArticle {
  /**
   * Primary Key.
   */
  id: string & tags.Format<"uuid">;
 
  /**
   * List of attached files.
   */
  files: null | IAttachmentFile[];
 
  /**
   * Title of the article.
   */
  title: null | (string & tags.MinLength<5> & tags.MaxLength<100>);
 
  /**
   * Main content body of the article.
   */
  body: string;
 
  /**
   * Creation time of article.
   */
  created_at: string & tags.Format<"date-time">;
}
 
export interface IAttachmentFile {
  /**
   * File name.
   */
  name: string & tags.Pattern<"^[a-z0-9]+$"> & tags.MaxLength<255>;
 
  /**
   * File extension.
   */
  extension: null | (string & tags.Pattern<"^[a-z0-9]+$"> & tags.MaxLength<8>);
 
  /**
   * URL of the file.
   */
  url: string;
}
```

ì¤‘ë³µë˜ëŠ” ì½”ë“œ ì—†ì´ ê¹”ë”í•˜ê²Œ íƒ€ì…ì„ í‘œê¸°í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Prisma

ì‹¬ì§€ì–´ëŠ” Prismaì™€ ì—°ê³„í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ `///` ì£¼ì„ì„ ì‚¬ìš©í•´ formattingí•˜ëŠ” ë°©ë²•ë„ ìˆë”êµ°ìš”!

```javascript
// prisma.schema
model bbs_articles {
  id String @id @db.Uuid /// @format uuid
  created_at DateTime @db.Timestamptz
 
  /// @minItems 1
  snapshots bbs_article_snapshots[]
}
 
model bbs_article_snapshots {
  id String @id @db.Uuid /// @format uuid
  bbs_article_id String @db.Uuid /// @format uuid
  format String @db.VarChar
 
  /// @minLength 5
  /// @maxLength 80
  title String @db.VarChar
  body String
  created_at DateTime @db.Timestamptz
 
  article bbs_articles @relation(fields: [bbs_article_id], references: [id])
}
```

### Mustache(OpenAPI-Generator Template)

ê¸°ì¡´ì— class-validatorë¡œ ì‘ì„±ë˜ì–´ìˆë˜ í…œí”Œë¦¿ì„ Typia ë°©ì‹ìœ¼ë¡œ ë°”ê¿¨ìŠµë‹ˆë‹¤. (Mustache/OpenAPI-Generatorì— ëŒ€í•´ì„œ ëª¨ë¥¸ë‹¤ë©´ ì´ [ê²Œì‹œê¸€](https://kkardd.github.io/study/2024-10-23-OpenAPI-Generator-For-NestJS/) ì°¸ì¡°)

```javascript
{{#models}}
{{#model}}
import { tags } from "typia";
export interface {{classname}} { {{#vars}}
    {{#description}}/** {{{description}}} */{{/description}}
    {{name}}{{^required}}?{{/required}}: {{{dataType}}}{{#pattern}} & tags.Pattern<"{{pattern}}">{{/pattern}}{{#minimum}} & tags.Minimum<{{minimum}}>{{/minimum}}{{#maximum}} & tags.Maximum<{{maximum}}>{{/maximum}}{{#minLength}} & tags.MinLength<{{minLength}}>{{/minLength}}{{#maxLength}} & tags.MaxLength<{{maxLength}}>{{/maxLength}}{{#isEmail}} & tags.Format<"email">{{/isEmail}}{{#isDate}} & tags.Format<"date">{{/isDate}}{{#isDateTime}} & tags.Format<"date-time">{{/isDateTime}};{{/vars}}
}
{{#vars}}
{{#isEnum}}
export type {{enumName}} = {{#allowableValues}}{{#values}}"{{.}}"{{^@last}} | {{/@last}}{{/values}}{{/allowableValues}};
{{/isEnum}}
{{/vars}}
{{/model}}
{{/models}}
```

ê¹”ë”í•˜ê²Œ ìƒì„±ë˜ì§€ëŠ” ì•ŠëŠ”ë°,, Mustacheë¡œëŠ” ì´ê²Œ ìµœì„ ê°™ë”êµ°ìš”. ì–´ì°¨í”¼ prettierì´ ì´ì˜ê²Œ ì •ë¦¬í•´ì¤„ê±°ë‹ˆ ë§Œì¡±í•©ë‹ˆë‹¤! 

# ğŸ’­Â Impression

TypiaëŠ” [í•œêµ­ì¸ ê°œë°œì](https://github.com/samchon)ê°€ ë§Œë“  ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¼ ë” ì‹ ê¸°í•œ ê±° ê°™ìŠµë‹ˆë‹¤. ë‚´ê°€ ë§Œë“ ê²ƒë„ ì•„ë‹Œë° ìë‘ìŠ¤ëŸ¬ìš´ ëŠë‚Œ..? ê·¸ë¦¬ê³  ì´ë¶„ì˜ ì†Œê°œê¸€ì´ ë„ˆë¬´ ë©‹ìˆì–´ìš”.

![image.jpg](../../assets/img/Study/Typia-24.jpg)

ì €ë ‡ê²Œ ìŠ¤ìŠ¤ë¡œì—ê²Œ ìë‘ìŠ¤ëŸ¬ìš´ ê°œë°œìê°€ ë˜ëŠ”ê²ƒë„ ëª©í‘œì¤‘ í•˜ë‚˜ë¡œ ì¡ì•„ì•¼ê² ì–´ìš” !
